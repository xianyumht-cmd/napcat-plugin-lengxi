{{extend commonLayout}}

{{block 'css'}}
<link rel="stylesheet" type="text/css" href="{{_res_path}}Template/flows/flows.css"/>
{{/block}}

{{block 'main'}}
<div class="container">
    <!-- 背景图片 -->
    <img class="bg-image" src="{{_res_path}}imgs/others/loading13.png" alt="" />
    
    <!-- 头部区域 -->
    <div class="header">
        <div class="header-left">
            <img class="game-logo" src="{{_res_path}}imgs/others/logo.png" alt="三角洲行动" />
        </div>
        <div class="header-center">
            <div class="title">{{typeName}}流水</div>
            <div class="subtitle">第 {{page}} 页</div>
        </div>
    </div>

    <div class="content">
        {{if typeValue === 1}}
        <!-- 设备流水 -->
        {{if playerInfo}}
        <div class="player-info">
            <div class="info-row info-row-main">
                <span class="info-item">
                    <span class="info-label">玩家：</span>
                    <span class="info-value">{{playerInfo.vRoleName}}</span>
                </span>
                <span class="info-item">
                    <span class="info-label">等级：</span>
                    <span class="info-value">{{playerInfo.Level}}</span>
                </span>
                <span class="info-item">
                    <span class="info-label">登录天数：</span>
                    <span class="info-value">{{playerInfo.loginDay}}</span>
                </span>
                {{if totalCount !== undefined}}
                <span class="info-item">
                    <span class="info-label">总登录次数：</span>
                    <span class="info-value">{{totalCount}}</span>
                </span>
                {{/if}}
            </div>
            
            {{if deviceStats && deviceStats.length > 0}}
            <div class="info-row">
                <span class="info-label">设备类型：</span>
                <div class="stat-tags">
                    {{each deviceStats device}}
                    <span class="stat-tag">
                        <span class="stat-tag-name">{{device.name}}</span>
                        <span class="stat-tag-count">{{device.count}}次</span>
                    </span>
                    {{/each}}
                </div>
            </div>
            {{/if}}

            {{if ipStats && ipStats.length > 0}}
            <div class="info-row">
                <span class="info-label">IP地址：</span>
                <div class="stat-tags">
                    {{each ipStats ip}}
                    <span class="stat-tag">
                        <span class="stat-tag-name">{{ip.ip}}</span>
                        <span class="stat-tag-count">{{ip.count}}次</span>
                    </span>
                    {{/each}}
                </div>
            </div>
            {{/if}}
        </div>
        {{/if}}

        {{if loginColumns && loginColumns.length > 0}}
        <div class="flow-list flow-list-five-column">
            {{each loginColumns column}}
            <div class="flow-column">
                {{each column record}}
                <div class="flow-item">
                    <div class="flow-header">
                        <span class="flow-index">[{{record.index}}]</span>
                        <span class="flow-time">{{record.indtEventTime}}</span>
                    </div>
                    <div class="flow-details">
                        <div class="detail-row">
                            <span class="detail-label">登出：</span>
                            <span class="detail-value">{{record.outdtEventTime}}</span>
                        </div>
                        <div class="detail-row">
                            <span class="detail-label">IP地址：</span>
                            <span class="detail-value">{{record.vClientIP}}</span>
                        </div>
                        <div class="detail-row">
                            <span class="detail-label">设备：</span>
                            <span class="detail-value">{{record.SystemHardware}}</span>
                        </div>
                    </div>
                </div>
                {{/each}}
            </div>
            {{/each}}
        </div>
        {{else}}
        <div class="empty-message">当前页无流水记录。</div>
        {{/if}}
        {{/if}}

        {{if typeValue === 2}}
        <!-- 道具流水 -->
        {{if itemColumns && itemColumns.length > 0}}
        <div class="flow-list flow-list-five-column">
            {{each itemColumns column}}
            <div class="flow-column">
                {{each column record}}
                <div class="flow-item">
                    <div class="flow-header">
                        <span class="flow-index">[{{record.index}}]</span>
                        <span class="flow-time">{{record.dtEventTime}}</span>
                    </div>
                    <div class="flow-details">
                        <div class="detail-row">
                            <span class="detail-label">物品：</span>
                            <span class="detail-value">{{record.Name}}</span>
                            <span class="detail-change {{record.changeType}}">{{record.AddOrReduce}}</span>
                        </div>
                        <div class="detail-row">
                            <span class="detail-label">原因：</span>
                            <span class="detail-value">{{record.Reason}}</span>
                        </div>
                    </div>
                </div>
                {{/each}}
            </div>
            {{/each}}
        </div>
        {{else}}
        <div class="empty-message">当前页无流水记录。</div>
        {{/if}}
        {{/if}}

        {{if typeValue === 3}}
        <!-- 货币流水 -->
        {{if moneyColumns && moneyColumns.length > 0}}
        <div class="flow-list flow-list-five-column">
            {{each moneyColumns column}}
            <div class="flow-column">
                {{each column record}}
                <div class="flow-item">
                    <div class="flow-header">
                        <span class="flow-index">[{{record.index}}]</span>
                        <span class="flow-time">{{record.dtEventTime}}</span>
                    </div>
                    <div class="flow-details">
                        <div class="detail-row">
                            <span class="detail-label">变动：</span>
                            <span class="detail-change {{record.changeType}}">{{record.AddOrReduce}}</span>
                            <span class="detail-label" style="margin-left: 20px;">余额：</span>
                            <span class="detail-value">{{record.leftMoney}}</span>
                        </div>
                        <div class="detail-row">
                            <span class="detail-label">原因：</span>
                            <span class="detail-value">{{record.Reason}}</span>
                        </div>
                    </div>
                </div>
                {{/each}}
            </div>
            {{/each}}
        </div>
        {{else}}
        <div class="empty-message">当前页无流水记录。</div>
        {{/if}}
        {{/if}}
    </div>
</div>
{{/block}}