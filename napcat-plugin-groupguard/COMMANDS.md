# GroupGuard 插件指令手册

本文档详细说明了 GroupGuard 插件支持的所有指令、权限要求及使用示例。

## 目录

1. [指令权限概览](#1-指令权限概览)
2. [私聊指令 (主人专用)](#2-私聊指令-主人专用)
3. [群聊管理指令 (管理员/群主/主人)](#3-群聊管理指令-管理员群主主人)
4. [群聊普通指令 (全员可用)](#4-群聊普通指令-全员可用)
5. [常见问题](#5-常见问题)

---

## 1. 指令权限概览

插件将用户权限分为三级：
*   **主人 (Owner)**: 在配置中 `ownerQQs` 设置的 QQ 号，拥有最高权限，可执行所有指令（包括私聊管理）。
*   **管理员 (Admin)**: 群内的管理员和群主，可执行大部分群管理指令（如踢人、禁言、开关功能）。
*   **普通成员**: 仅可使用签到、查询积分等互动指令。

**注意**:
*   大部分群管理指令需要 **群授权** (专业版/企业版) 才能使用。
*   未授权的群，插件将处于静默状态，仅响应极少数指令（如私聊授权）。

---

## 2. 私聊指令 (主人专用)

出于安全考虑，敏感的授权和全局设置仅支持通过 **私聊** 向机器人发送，且仅限 **主人** 使用。

| 指令 | 说明 | 示例 |
| :--- | :--- | :--- |
| `授权 <群号> <天数>` | 给指定群授权。天数为 `永久` 时授予企业版，数字则为专业版。 | `授权 123456 30`<br>`授权 123456 永久` |
| `回收授权 <群号>` | 取消指定群的授权。 | `回收授权 123456` |
| `查询授权 <群号>` | 查询群的授权状态和剩余时间。 | `查询授权 123456` |
| `菜单` / `帮助` | 获取私聊管理面板，显示全局设置和指令说明。 | `菜单` |

---

## 3. 群聊管理指令 (管理员/群主/主人)

以下指令需在群内发送，操作者需为 **群管理员**、**群主** 或 **机器人主人**。

### 🛡️ 基础管理
| 指令 | 说明 | 示例 |
| :--- | :--- | :--- |
| `踢出 <@某人/QQ>` | 将用户踢出群聊。 | `踢出 @张三` |
| `禁言 <@某人/QQ> <分钟>` | 禁言用户指定时长（默认10分钟）。 | `禁言 @张三 30` |
| `解禁 <@某人/QQ>` | 解除用户禁言。 | `解禁 @张三` |
| `全体禁言` | 开启全员禁言。 | `全体禁言` |
| `全体解禁` | 关闭全员禁言。 | `全体解禁` |
| `群拉黑 <@某人/QQ>` | 将用户加入本群黑名单（自动踢出并拦截消息）。 | `群拉黑 @张三` |
| `群取消拉黑 <@某人/QQ>` | 将用户移出本群黑名单。 | `群取消拉黑 @张三` |
| `群黑名单列表` | 查看本群黑名单。 | `群黑名单列表` |

### ⚙️ 功能开关
| 指令 | 说明 |
| :--- | :--- |
| `开启/关闭入群验证` | 开启后，新成员进群需回答数学题，超时或答错踢出。 |
| `开启/关闭自动审批` | 开启后，自动同意入群申请（需机器人有管理员权限）。 |
| `开启/关闭刷屏检测` | 开启后，检测高频发言和复读刷屏。 |
| `开启/关闭退群拉黑` | 开启后，成员主动退群将自动加入黑名单。 |
| `开启/关闭防撤回` | 开启后，拦截成员撤回的消息并重新发送（带提示）。 |
| `开启/关闭二维码撤回` | 开启后，自动识别并撤回包含二维码的图片。 |
| `开启/关闭回应表情` | 开启后，随机或对特定用户消息进行表情回应。 |
| `开启/关闭自身撤回` | 开启后，机器人自己发送的消息会在指定时间后撤回。 |

### 🔧 高级配置
| 指令 | 说明 | 示例 |
| :--- | :--- | :--- |
| `设置欢迎词 <内容>` | 设置入群欢迎语。支持 `{user}`(AT用户), `{group}`(群号)。 | `设置欢迎词 欢迎 {user} 加入本群！` |
| `设置权限缓存 <秒>` | 设置管理员权限缓存时间（减少API调用，0为关闭）。 | `设置权限缓存 60` |
| `开启宵禁 <开始> <结束>` | 设置每日自动全员禁言时间段。 | `开启宵禁 00:00 06:00` |
| `关闭宵禁` | 关闭宵禁功能。 | `关闭宵禁` |
| `定时任务 <时间> <内容>` | 添加每日定时发送的消息。 | `定时任务 08:00 大家早上好` |
| `删除定时任务 <ID>` | 删除指定ID的定时任务。 | `删除定时任务 kx7d2` |
| `定时列表` | 查看本群所有定时任务及ID。 | `定时列表` |

## 入群验证（商用）
- `设置入群暗号 <暗号>`：设置入群验证暗号（区分大小写，自动去空格）。
- `关闭入群暗号`：关闭暗号验证功能。
- `开启暗号回落`：暗号关闭后，继续使用原有的自动同意/拒绝词规则（默认开启）。
- `关闭暗号回落`：暗号关闭后，不再自动处理申请，全部交给管理员。

## 安全与数据
- `清空群配置`：(仅主人) ⚠️ 清空本群所有配置和数据（问答、日志等）。需二次确认。
- `确认清空群配置`：(仅主人) 确认执行清空操作。

## 违禁词与拒绝词
- `添加违禁词 <词语>`：添加本群违禁词（撤回+禁言）。
- `删除违禁词 <词语>`：删除本群违禁词。
- `添加全局违禁词 <词语>`：(仅主人) 添加所有群生效的违禁词。
- `删除全局违禁词 <词语>`：(仅主人) 删除全局违禁词。
- `违禁词列表`：查看本群及全局违禁词。
- `添加拒绝词 <词语>`：添加本群入群拒绝关键词。
- `删除拒绝词 <词语>`：删除本群入群拒绝关键词。
- `添加全局拒绝词 <词语>`：(仅主人) 添加所有群生效的拒绝词。
- `删除全局拒绝词 <词语>`：(仅主人) 删除全局拒绝词。
- `拒绝词列表`：查看本群及全局拒绝词。

## 问答管理
| 指令 | 说明 | 示例 |
| :--- | :--- | :--- |
| `模糊问<A>答<B>` | 添加模糊匹配问答（消息包含A即回复B）。 | `模糊问官网答是 www.example.com` |
| `精确问<A>答<B>` | 添加精确匹配问答（消息等于A才回复B）。 | `精确问价格答请看置顶公告` |
| `删除问答 <关键词>` | 删除指定关键词的问答。 | `删除问答 官网` |
| `问答列表` | 查看本群所有问答配置。 | `问答列表` |

### ⚠️ 警告系统
| 指令 | 说明 | 示例 |
| :--- | :--- | :--- |
| `警告 <@某人>` | 警告用户一次。达到上限（默认3次）将自动踢出或禁言。 | `警告 @张三` |
| `查看警告 <@某人>` | 查看用户当前的警告次数。 | `查看警告 @张三` |
| `清除警告 <@某人>` | 清除用户的警告记录。 | `清除警告 @张三` |

---

## 4. 群聊普通指令 (全员可用)

以下指令所有群成员均可使用，旨在增加群活跃度。

| 指令 | 说明 | 示例 |
| :--- | :--- | :--- |
| `签到` | 每日签到获取积分，连续签到有奖励。 | `签到` |
| `签到榜` | 查看今日签到排行榜。 | `签到榜` |
| `我的积分` | 查看自己当前的积分。 | `我的积分` |
| `抽奖` | 消耗积分进行抽奖（需管理员开启）。 | `抽奖` |
| `邀请查询` | 查询自己邀请入群的人数。 | `邀请查询` |
| `邀请榜` | 查看群内邀请人数排行榜。 | `邀请榜` |
| `活跃统计` | 查看本群活跃度统计（消息数排行）。 | `活跃统计` |
| `运行状态` | 查看机器人运行状态（运行时长、内存等）。 | `运行状态` |

---

## 5. 常见问题

**Q: 为什么我在群里发“授权”没反应？**
A: 为了防止群聊刷屏和泄露信息，**授权相关指令仅支持私聊机器人发送**，且仅限主人账号操作。

**Q: 为什么管理员无法使用管理指令？**
A: 请检查：
1. 机器人是否已在该群获得授权（私聊查询）。
2. 发送指令的人是否在群内拥有“管理员”或“群主”头衔。
3. 机器人自身是否为管理员（部分功能如踢人、禁言需要机器人有管理权限）。

**Q: 问答设置支持图片吗？**
A: 支持。在设置回复内容时，如果消息中包含图片（CQ码），机器人会原样发送图片。

**Q: 数据存在哪里？**
A: 所有数据（配置、签到、日志等）均保存在插件目录下的 `data/groups/{群号}/` 文件夹中，分群隔离，互不干扰。
